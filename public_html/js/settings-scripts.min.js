$(document).ready(function(){var a={startSaving:function(){$("#saving-settings").show()},endSaving:function(){$("#saving-settings").hide();$("#saved-message").fadeIn().delay(1E3).fadeOut()},updateCategory:function(c){a.startSaving();$.ajax({type:"POST",url:"/categories/update",data:c,success:function(){a.endSaving()}})},updateOrder:function(a){$.ajax({type:"POST",url:"/categories/sort_categories",data:a.sortable("serialize")})}},f=function(){function a(){$(document.body).height($(window).height())}
return{init:function(){a();$(window).resize(a);$(document.body).click(function(){$(".cat-editor").remove()});$(".cat-settings-col").click(function(a){a.stopPropagation()})}}}(),g=function(){function c(){var c=$(this);c.hasClass("col-select-1")&&$(document.body).hasClass("layout-2")&&(a.startSaving(),$.ajax({type:"POST",url:"/users/update_layout",data:{layout:1},success:function(){$(document.body).removeClass("layout-2").addClass("layout-1");$(".in-col-2").appendTo($(".cat-settings-col-1"));$(".cat-settings-col-2").remove();
a.endSaving()}}));c.hasClass("col-select-2")&&$(document.body).hasClass("layout-1")&&(a.startSaving(),$.ajax({type:"POST",url:"/users/update_layout",data:{layout:2},success:function(){$(document.body).removeClass("layout-1").addClass("layout-2");$(".categories-section .content").append('<ul class="cat-settings-col cat-settings-col-2" />');$(".in-col-2").appendTo($(".cat-settings-col-2"));a.endSaving()}}))}return{init:function(){$(".col-select li").click(c)}}}(),h=function(){function c(b){$(this);
var e=$("#new-cat"),d=$("#cat-creator");b.preventDefault();d.hasClass("adding-cat")?(""!==e.val()&&$.ajax({type:"POST",url:"/categories/create",data:{category:e.val()},success:function(b){$(b).appendTo($(".cat-settings-col-1"));a.updateOrder($(".cat-settings-col-1"))}}),e.hide().val(""),d.removeClass("adding-cat").css("width",0)):(d.animate({width:152}).addClass("adding-cat"),e.fadeIn().focus())}function f(b){b.preventDefault();$("#add-cat").trigger("click")}function g(){var b=$(this),a=b.parent(),
b=['<form class="cat-editor" accept-charset="utf-8" method="post" action="/categories/update">','<input type="text" class="edit-cat-name" value="'+b.html()+'" />','<input type="submit" class="save-cat-name" value="Save">',"</form>"];$(b.join("")).appendTo(a).fadeIn("fast",function(){a.find(".edit-cat-name").focus()})}function h(b){var e=$(this).parent(),d=e.parent(),c=e.children(".edit-cat-name").val();b.preventDefault();a.updateCategory({id:d.data("id"),category:c});d.children(".cat-name").html(c);
e.remove()}function i(b){b.preventDefault();b=$(this).parent().parent();a.updateCategory({id:b.data("id"),display:b.hasClass("no-display")?1:0});b.toggleClass("no-display")}var j={placeholder:"ui-settings-placeholder",handle:".cat-handle",connectWith:".cat-settings-col",revert:250,update:function(b,c){var d=$(this);this===c.item.parent()[0]&&(a.updateOrder(d),a.updateCategory({id:c.item.data("id"),column:d.data("col")}))}};return{init:function(){$(".cat-settings-col").sortable(j);$("#add-cat").click(c);
$("#submit-cat").click(f);$(".cat-settings-col").on("click",".cat-name",g);$(".cat-settings-col").on("click",".save-cat-name",h);$(".cat-settings-col").on("click",".toggle-display",i)}}}();f.init();g.init();h.init()});